<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sem치foro de Bienestar</title>
    <link rel="apple-touch-icon" href="https://emojicdn.elk.sh/游뚼">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-100">
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;
        function App() {
            const [historial, setHistorial] = useState([]);
            const [nota, setNota] = useState("");
            const [bloqueado, setBloqueado] = useState({ ma침ana: false, tarde: false });

            useEffect(() => {
                const stored = localStorage.getItem('historialSemaforo');
                if (stored) {
                    const parsed = JSON.parse(stored);
                    setHistorial(parsed);
                    const hoy = new Date().toLocaleDateString();
                    setBloqueado({
                        ma침ana: parsed.some(r => r.fechaCorta === hoy && r.franja === "Ma침ana"),
                        tarde: parsed.some(r => r.fechaCorta === hoy && r.franja === "Tarde/Noche")
                    });
                }
            }, []);

            const guardar = (valor, color, emoji) => {
                const ahora = new Date();
                const franja = ahora.getHours() < 15 ? "Ma침ana" : "Tarde/Noche";
                const nuevo = {
                    id: Date.now(),
                    fechaCorta: ahora.toLocaleDateString(),
                    hora: ahora.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                    franja, valor, color, emoji, nota: nota || "Sin notas"
                };
                const nuevoHistorial = [nuevo, ...historial];
                setHistorial(nuevoHistorial);
                localStorage.setItem('historialSemaforo', JSON.stringify(nuevoHistorial));
                setNota("");
                setBloqueado(prev => ({ ...prev, [franja === "Ma침ana" ? 'ma침ana' : 'tarde']: true }));
            };

            const franjaActual = new Date().getHours() < 15 ? "Ma침ana" : "Tarde/Noche";
            const estaBloqueado = (franjaActual === "Ma침ana" && bloqueado.ma침ana) || (franjaActual === "Tarde/Noche" && bloqueado.tarde);

            return (
                <div class="max-w-md mx-auto min-h-screen bg-white shadow-xl flex flex-col">
                    <header class="p-6 bg-blue-600 text-white text-center rounded-b-2xl">
                        <h1 class="text-2xl font-bold">MI SEM츼FORO</h1>
                        <p class="text-sm">Registro de {franjaActual}</p>
                    </header>
                    <main class="p-6 space-y-6">
                        <div class="bg-gray-50 p-4 rounded-xl border border-blue-100">
                            {estaBloqueado ? (
                                <p class="text-center text-gray-500 font-bold">춰Registro de {franjaActual} completado!</p>
                            ) : (
                                <div class="space-y-4">
                                    <input type="text" value={nota} onChange={(e) => setNota(e.target.value)} placeholder="쯇or qu칠?" class="w-full p-3 border rounded-lg outline-none focus:ring-2 focus:ring-blue-400" />
                                    <div class="flex justify-around">
                                        <button onClick={() => guardar(3, 'bg-green-500', '游땕')} class="text-4xl p-4 bg-green-500 rounded-full shadow-lg">游땕</button>
                                        <button onClick={() => guardar(2, 'bg-orange-500', '游땛')} class="text-4xl p-4 bg-orange-500 rounded-full shadow-lg">游땛</button>
                                        <button onClick={() => guardar(1, 'bg-red-500', '游')} class="text-4xl p-4 bg-red-500 rounded-full shadow-lg">游</button>
                                    </div>
                                </div>
                            )}
                        </div>
                        <div class="space-y-3">
                            <h2 class="font-bold text-gray-700">Historial</h2>
                            {historial.map(reg => (
                                <div key={reg.id} class="flex items-center p-3 bg-white border rounded-lg shadow-sm">
                                    <div class={`w-10 h-10 rounded-full ${reg.color} flex items-center justify-center text-xl mr-3`}>{reg.emoji}</div>
                                    <div class="flex-1">
                                        <div class="flex justify-between text-[10px] text-gray-400 font-bold uppercase">
                                            <span>{reg.franja}</span><span>{reg.fechaCorta}</span>
                                        </div>
                                        <p class="text-sm font-medium">{reg.nota}</p>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </main>
                </div>
            );
        }
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
